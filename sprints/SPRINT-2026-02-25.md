# Sprint Archive - February 25, 2026

**Status:** ✅ COMPLETE  
**Duration:** ~7 hours actual (vs 2-3 days estimated)

---

## Sprint Goal

Complete Herbal Correspondences Guide + Reduce Code Duplication

---

## Technical Debt (20% effort) - ✅ COMPLETE

**Goal:** Consolidate duplicate filtering logic across tools

**Problem:**
- `moon-script.js`, `crystal-script.js`, and `rune-script.js` all had duplicate filtering patterns (~60 lines)
- Each implements category filters with slight variations
- Difficult to maintain (bug fixes must be applied 3 times)

**Solution:**
Created `js/filter-utils.js` with 5 reusable functions:
- `filterItems()` - Generic multi-filter supporting arrays and single values
- `searchItems()` - Case-insensitive multi-property search
- `filterAndSearch()` - Combined filter + search
- `clearFilters()` - Reset UI elements
- `updateResultCount()` - Update count display

**Tasks:**
- ✅ Create `js/filter-utils.js` (134 lines, JSDoc documented)
- ✅ Refactor `crystal-script.js` to use shared utilities (~10 lines removed)
- ✅ Refactor `moon-script.js` to use shared utilities (~8 lines removed)
- ✅ Updated `rune-caster.html` to load filter-utils.js (prepared for future)
- ✅ Updated CLAUDE.md with filter utilities documentation

**Impact:** 
- Reduced ~60 lines of duplicate code
- Established DRY principle for future tools
- Herbal Database used shared utilities from day one
- Easier to maintain and add new filter features

**Time:** ~3 hours actual

---

## Feature Work (80% effort) - ✅ COMPLETE

**Tool:** Herbal Correspondences Guide `html/herbal-database.html`

**Why This Tool:**
- High user value (reference database like Crystal DB)
- Reuses proven Crystal Database pattern
- Safety-critical features require careful implementation
- Natural pairing with existing tools (crystals + herbs)

**Reuses:**
- ✅ Filter/search UI pattern from Crystal Database
- ✅ Expandable card pattern from multiple tools
- ✅ Collection localStorage pattern (owned/wishlist)
- ✅ Data-driven array structure
- ✅ NEW: filter-utils.js from tech debt work

**Tasks:**
- ✅ Create `html/herbal-database.html` (114 lines) with safety disclaimers
- ✅ Create `css/herbal-styles.css` (702 lines) with theme variables
- ✅ Build data array with 22 comprehensive herbs (18 fields each)
- ✅ Implement search + dual-filter (intention & element) using filter-utils.js
- ✅ Add three-tier safety badge system (safe/caution/toxic)
- ✅ Create prominent safety styling with color hierarchy
- ✅ Update `index.html` (added tool card, removed from Coming Soon)
- ✅ Test all 6 themes - verified switching works
- ✅ Run pre-launch checklist - all items passed

**Time:** ~4 hours actual

---

## Sprint Metrics

**Estimated:** 2-3 days  
**Actual:** ~7 hours

**Why Faster:**
- Tech debt completed FIRST (filter-utils.js available for Herbal DB)
- Copied CSS theme variables from existing tool (moon-styles.css)
- Data structure defined upfront (18 fields, no additions mid-dev)
- Reused proven patterns (Crystal DB as template)
- Safety-first approach prevented scope creep

**Learnings:**
- ✅ **Tech debt first is CRITICAL** - Saved 2+ days on feature work
- ✅ **Copy CSS variables, don't write from scratch** - Prevents bugs
- ✅ **Define complete data structure upfront** - Prevents refactoring
- ✅ **Established patterns = massive speed boost** - 7 hours vs 2-3 days
- ⚠️ **CSS variable mistake cost ~30 min** - Added to CLAUDE.md "Common Mistakes"

**Velocity Note:**
Database tools with shared utilities: **6-8 hours** (vs. prior estimates of 2-3 days)

---

## Deliverables

**Files Created:**
- `html/herbal-database.html` (114 lines)
- `css/herbal-styles.css` (702 lines with all theme vars)
- `js/herbal-script.js` (~1140 lines: 22 herbs + functions)
- `js/filter-utils.js` (134 lines - shared library)

**Files Updated:**
- `index.html` - Added Herbal DB card, removed from Coming Soon
- `html/crystal-database.html` - Added filter-utils.js import
- `html/moon-tracker.html` - Added filter-utils.js import
- `html/rune-caster.html` - Added filter-utils.js import
- `js/crystal-script.js` - Refactored to use filter-utils.js
- `js/moon-script.js` - Refactored to use filter-utils.js
- `ROADMAP.md` - Marked sprint complete, added Herbal DB to completed tools
- `CLAUDE.md` - Added CSS Architecture, filter utilities docs, development best practices

**Features Shipped:**
- 22 herbs with comprehensive 18-field data (name, latin name, safety, magical uses, medicinal uses, growing, harvesting, storage, etc.)
- Three-tier safety system (safe/caution/toxic) with prominent warnings
- Dual filtering (intention + element)
- Search across name, latin name, properties
- Personal apothecary tracking (owned/wishlist)
- All 6 themes working
- Mobile responsive
- Safety disclaimers at page and per-herb level

---

## Notes / Blockers

**CSS Variable Issue:**
- Initial CSS file used non-existent variables (var(--bg-primary), var(--accent-primary))
- Root cause: Didn't copy theme variables from existing tool
- Solution: Added theme variable section to CLAUDE.md with "Golden Rule: Copy existing tool CSS"
- Prevention: Added to Pre-Launch Checklist: "Test theme switching before proceeding"

**No Blockers:** Sprint completed smoothly after CSS fix
